---
title: "Wrangling"
output:
editor_options:
  chunk_output_type: console
---


In this practical, you will read in the `taxation.csv` data set and analyze it descriptively using the `dplyr` package.

# 0 - Preliminaries

1. Run the line below to load the `tidyverse`. To do this you can either place the cursor on the line and then hit Cmd-Enter (Mac) or Ctrl-Enter (Windows). Alternatively you can click on one of the symbols in the top-right corner of the code chunk. If you have not previously installed the `tidyverse`, run `install.packages("tidyverse")` and then the line below. 

```{r }
library(tidyverse)
```

2. Use the code below to read in the `taxation.csv` and store it as an object called `basel`. Note the messages. They tell how R has inferred the types of each of the columns. Should be all good.

```{r }
basel <- read_csv('1_Data/taxation.csv')
```

3. Take a look at `basel` by sending it to console. Note how the `tibble` shows types for each of the columns. Also note how some cases and variables are abbreviated. 

```{r }
basel
```

# 1 - Summarize

1. Let's analyze some data. Complete the code below to compute average Gini coefficient for income (`income_gini`) for Basel across all years. Simply replace `XX` with the appropriate variable name.

```{r }
basel %>% 
  summarize(avg_gini_income = mean(XX))
```

2. Now add another statement within `summarize` to also calculate the average Gini for wealth. What do make of the results? Think of the distributions and corresponding Gini values from the intro presentation. 

```{r }
basel %>% 
  summarize(avg_gini_income = mean(XX),
            avg_gini_wealth = mean(XX))
```

# 2 - Filter

1. Now look at the average Gini coefficients just for one quarter, namely `"Bettingen"`. 

```{r }
basel %>% 
  filter(quarter == XX) %>% 
  summarize(avg_gini_income = mean(XX),
            avg_gini_wealth = mean(XX))
```

2. Now try `"Gundeldingen"`. How do the results compare?  

```{r }
basel %>% 
  filter(quarter == XX) %>% 
  summarize(avg_gini_income = mean(XX),
            avg_gini_wealth = mean(XX))
```

# 3 - Grouping

1. Wouldn't it be great if one did have to select each quarter one by one using filter? The `group_by` and`summarize` idiom saves from eaxactly that. Complete the code below to calculate the average Gini coefficients for every `quarter`.  

```{r }
basel %>% 
  group_by(XX) %>% 
  summarize(avg_gini_income = mean(XX),
            avg_gini_wealth = mean(XX))
```

2. R has printed only 10 of the 21 quarters due to a default setting for the `tibble` print. Overwrite this setting by telling R exactly how many rows you would like to see. 

```{r }
basel %>% 
  group_by(XX) %>% 
  summarize(avg_gini_income = mean(XX),
            avg_gini_wealth = mean(XX)) %>% 
  print(n = XX)
```

3. Looks like there are some differences between the quarters. How about arranging the results such that the quarters are sorted in according to `avg_gini_income`. Which quarter has the highest Gini coefficients, which the lowest? How different are the two?

```{r }
basel %>% 
  group_by(XX) %>% 
  summarize(avg_gini_income = mean(XX),
            avg_gini_wealth = mean(XX)) %>% 
  arrange(XX) %>% 
  print(n = XX)
```

# 4 - Pivoting

1. Finally, build on the previous chunk to transpose the data into a long format. The first argument specifies the vector of to be transposed columns. The next two specify the column names of the two variables in the long format carrying the previous column names and column values, respectively.  

```{r }
basel %>% 
  group_by(XX) %>% 
  summarize(avg_gini_income = mean(XX),
            avg_gini_wealth = mean(XX)) %>% 
  pivot_longer(XX, names_to = "XX", values_to = "XX")
```

# 5 - Go explore

1. Calculate the average income and wealth across time?

2. How has the mean income/wealth developed relative to the median?






